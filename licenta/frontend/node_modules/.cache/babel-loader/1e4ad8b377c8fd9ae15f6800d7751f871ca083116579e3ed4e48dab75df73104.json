{"ast":null,"code":"import'./app.css';import{useEffect,useState}from'react';import{Routes,Route}from'react-router-dom';import{UserContext}from'./context/context';import{getToken}from'./utils/jwt';import{getUserRoleFromServer}from'./api/auth';import NewBookForm from'./components/book/new-book-form/new-book-form';import Header from'./components/header/header';import Footer from'./components/footer/footer';import AuthPage from'./pages/auth/auth-page';import OrdersPage from'./pages/orders-page/orders-page';import UsersPage from'./pages/users-page/users-page';import BooksPage from'./pages/books-page/books-page';import PageNotFound from'./pages/404/404';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function App(){const[role,setRole]=useState('');const[userId,setUserId]=useState(null);const[status,setStatus]=useState('');// context does not persist on refresh\nuseEffect(()=>{// validate token if exists, extract role every time the homepage (re)loads in case token changed\ngetUserRoleFromServer(getToken(),setRole,setUserId,setStatus);});function getElement(route){switch(role){case'ADMIN':// admin can only be active\nswitch(route){case'/':return/*#__PURE__*/_jsx(UsersPage,{});case'/carti':return/*#__PURE__*/_jsx(BooksPage,{isAdmin:true});case'/adauga':return/*#__PURE__*/_jsx(NewBookForm,{});case'/comenzi':return/*#__PURE__*/_jsx(OrdersPage,{isAdmin:true});default:// should never enter here, but just in case\nreturn/*#__PURE__*/_jsx(PageNotFound,{});}case'READER':if(status==='WAITING FOR APPROVE'){return/*#__PURE__*/_jsxs(\"div\",{className:\"status-page\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/pending.svg\",alt:\"pending\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Un administrator trebuie sa iti aprobe cererea de inscriere. Te rugam sa revii mai tarziu.\"})]});}else if(status==='ACTIVE'){switch(route){case'/':return/*#__PURE__*/_jsx(BooksPage,{});case'/comenzi':return/*#__PURE__*/_jsx(OrdersPage,{});default:// should never enter here, but just in case\nreturn/*#__PURE__*/_jsx(PageNotFound,{});}}else if(status==='BANNED'){return/*#__PURE__*/_jsxs(\"div\",{className:\"status-page\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/banned.svg\",alt:\"banned\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Contul tau a fost inchis permanent.\"})]});}else{return/*#__PURE__*/_jsx(\"p\",{children:\"Nu ar fi trebuit sa ajungi aici\"});}default:if(route==='/'){return/*#__PURE__*/_jsx(AuthPage,{});}else{return/*#__PURE__*/_jsx(PageNotFound,{});}}}return/*#__PURE__*/_jsxs(UserContext.Provider,{value:{role,setRole,userId,setUserId,status,setStatus},children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(\"main\",{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:getElement('/')}),/*#__PURE__*/_jsx(Route,{path:\"/carti\",element:getElement('/carti')}),/*#__PURE__*/_jsx(Route,{path:\"/adauga\",element:getElement('/adauga')}),/*#__PURE__*/_jsx(Route,{path:\"/comenzi\",element:getElement('/comenzi')}),/*#__PURE__*/_jsx(Route,{path:\"*\",exact:true,element:/*#__PURE__*/_jsx(PageNotFound,{})})]})}),/*#__PURE__*/_jsx(Footer,{})]});}","map":{"version":3,"names":["useEffect","useState","Routes","Route","UserContext","getToken","getUserRoleFromServer","NewBookForm","Header","Footer","AuthPage","OrdersPage","UsersPage","BooksPage","PageNotFound","jsx","_jsx","jsxs","_jsxs","App","role","setRole","userId","setUserId","status","setStatus","getElement","route","isAdmin","className","children","src","alt","Provider","value","path","element","exact"],"sources":["C:/Users/conac/Desktop/OFICIAL/bookstore/frontend/src/app.jsx"],"sourcesContent":["import './app.css'\r\nimport { useEffect, useState } from 'react'\r\nimport { Routes, Route } from 'react-router-dom'\r\nimport { UserContext } from './context/context'\r\nimport { getToken } from './utils/jwt'\r\nimport { getUserRoleFromServer } from './api/auth'\r\n\r\nimport NewBookForm from './components/book/new-book-form/new-book-form'\r\nimport Header from './components/header/header'\r\nimport Footer from './components/footer/footer'\r\n\r\nimport AuthPage from './pages/auth/auth-page'\r\nimport OrdersPage from './pages/orders-page/orders-page'\r\nimport UsersPage from './pages/users-page/users-page'\r\nimport BooksPage from './pages/books-page/books-page'\r\nimport PageNotFound from './pages/404/404'\r\n\r\nexport default function App() {\r\n    const [role, setRole] = useState('')\r\n    const [userId, setUserId] = useState(null)\r\n    const [status, setStatus] = useState('')\r\n\r\n    // context does not persist on refresh\r\n    useEffect(() => {\r\n        // validate token if exists, extract role every time the homepage (re)loads in case token changed\r\n        getUserRoleFromServer(getToken(), setRole, setUserId, setStatus)\r\n    })\r\n\r\n    function getElement(route) {\r\n        switch(role) {\r\n            case 'ADMIN': // admin can only be active\r\n                switch(route) {\r\n                    case '/':\r\n                        return <UsersPage />\r\n                    case '/carti':\r\n                        return <BooksPage isAdmin={true}/>\r\n                    case '/adauga':\r\n                        return <NewBookForm />\r\n                    case '/comenzi':\r\n                        return <OrdersPage isAdmin={true} />\r\n                    default: // should never enter here, but just in case\r\n                        return <PageNotFound />\r\n                }\r\n            case 'READER':\r\n                if (status === 'WAITING FOR APPROVE') {\r\n                    return (\r\n                        <div className=\"status-page\">\r\n                            <img src=\"/pending.svg\" alt=\"pending\" />\r\n                            <p>Un administrator trebuie sa iti aprobe cererea de inscriere. Te rugam sa revii mai tarziu.</p>\r\n                        </div>\r\n                    )\r\n                } else if (status === 'ACTIVE') {\r\n                    switch(route) {\r\n                        case '/':\r\n                            return <BooksPage />\r\n                        case '/comenzi':\r\n                            return <OrdersPage />\r\n                        default: // should never enter here, but just in case\r\n                            return <PageNotFound />\r\n                    }\r\n                } else if (status === 'BANNED') {\r\n                    return (\r\n                        <div className=\"status-page\">\r\n                            <img src=\"/banned.svg\" alt=\"banned\" />\r\n                            <p>Contul tau a fost inchis permanent.</p>\r\n                        </div>\r\n                    )\r\n                } else {\r\n                    return <p>Nu ar fi trebuit sa ajungi aici</p>\r\n                }\r\n            default:\r\n                if (route === '/') {\r\n                    return <AuthPage />\r\n                } else {\r\n                    return <PageNotFound />\r\n                }\r\n        }\r\n    }\r\n\r\n    return (\r\n        <UserContext.Provider value={{ role, setRole, userId, setUserId, status, setStatus }}>\r\n            <Header />\r\n            <main>\r\n                <Routes>\r\n                    <Route path='/' element={getElement('/')} />\r\n                    <Route path='/carti' element={getElement('/carti')} />\r\n                    <Route path='/adauga' element={getElement('/adauga')} />\r\n                    <Route path='/comenzi' element={getElement('/comenzi')} />\r\n                    <Route path='*' exact={true} element={<PageNotFound />} />\r\n                </Routes>\r\n            </main>\r\n            <Footer />\r\n        </UserContext.Provider>\r\n    )\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}