{"ast":null,"code":"import{useState}from'react';import{login}from'../../../api/auth';import Error from'../../error/error';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function LoginForm(_ref){let{setShowForgotPassword,setShowLoginForm}=_ref;const[email,setEmail]=useState('');const[password,setPassword]=useState('');const[errorMessage,setErrorMessage]=useState('');async function handleFormSubmit(event){// prevent redirect before validations\nevent.preventDefault();try{const loginResponse=await login(email,password);const json=await loginResponse.json();// check for error\nconst status=loginResponse.status;if(status!==201){setErrorMessage(json.message);return;}// read jwt from response and set as cookie\ndocument.cookie=\"token=\".concat(json.token,\";max-age=\").concat(json.expirationDate*1000);// \"redirect\" to correct page\nwindow.location.reload();}catch(e){// server died or response could not be read\nsetErrorMessage('Ceva nu a mers. Te rugam sa revii mai tarziu.');}}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:event=>handleFormSubmit(event),className:\"login-form\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",onChange:event=>setEmail(event.target.value),placeholder:\"utilizator@email.com\",required:true}),/*#__PURE__*/_jsx(\"label\",{children:\"Parola\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",onChange:event=>setPassword(event.target.value),placeholder:\"parola\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowForgotPassword(true),className:\"forgot-password-button\",children:\"Am uitat parola\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Login\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Nu ai cont? \",/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowLoginForm(false),children:\"Inregistreaza-te!\"})]})]}),/*#__PURE__*/_jsx(Error,{message:errorMessage})]});}","map":{"version":3,"names":["useState","login","Error","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","LoginForm","_ref","setShowForgotPassword","setShowLoginForm","email","setEmail","password","setPassword","errorMessage","setErrorMessage","handleFormSubmit","event","preventDefault","loginResponse","json","status","message","document","cookie","concat","token","expirationDate","window","location","reload","e","children","onSubmit","className","type","onChange","target","value","placeholder","required","onClick"],"sources":["C:/Users/conac/Desktop/OFICIAL/bookstore/frontend/src/components/auth/login-form/login-form.jsx"],"sourcesContent":["import { useState } from 'react'\r\nimport { login } from '../../../api/auth'\r\nimport Error from '../../error/error'\r\n\r\nexport default function LoginForm({ setShowForgotPassword, setShowLoginForm }) {\r\n    const [email, setEmail] = useState('')\r\n    const [password, setPassword] = useState('')\r\n    const [errorMessage, setErrorMessage] = useState('')\r\n\r\n    async function handleFormSubmit(event) {\r\n        // prevent redirect before validations\r\n        event.preventDefault()\r\n        try {\r\n            const loginResponse = await login(email, password)\r\n            const json = await loginResponse.json()\r\n\r\n            // check for error\r\n            const status = loginResponse.status\r\n            if (status !== 201) {\r\n                setErrorMessage(json.message)\r\n                return\r\n            }\r\n\r\n            // read jwt from response and set as cookie\r\n            document.cookie = `token=${json.token};max-age=${json.expirationDate * 1000}`\r\n            // \"redirect\" to correct page\r\n            window.location.reload()\r\n        } catch (e) { // server died or response could not be read\r\n            setErrorMessage('Ceva nu a mers. Te rugam sa revii mai tarziu.')\r\n        }\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <form onSubmit={(event) => handleFormSubmit(event)} className=\"login-form\">\r\n                <label>Email</label>\r\n                <input type=\"email\" onChange={(event) => setEmail(event.target.value)} placeholder=\"utilizator@email.com\" required/>\r\n                <label>Parola</label>\r\n                <input type=\"password\" onChange={(event) => setPassword(event.target.value)} placeholder=\"parola\" required/>\r\n                <button type=\"button\" onClick={() => setShowForgotPassword(true)} className=\"forgot-password-button\">Am uitat parola</button>\r\n                <button type=\"submit\">Login</button>\r\n                <p>Nu ai cont? <button type=\"button\" onClick={() => setShowLoginForm(false)}>Inregistreaza-te!</button></p>\r\n            </form>\r\n            <Error message={errorMessage} />\r\n        </>\r\n    )\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}